@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" defer></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<style>
    @@import url('https://fonts.googleapis.com/css2?family=Fasthand&family=Poppins:wght@300;400;500;600;700&display=swap');

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background-image: url(https://www.workato.com/product-hub/wp-content/uploads/2022/01/Dec-product-header-new-2.gif);
        background-size: cover;
        font-family: "Poppins", sans-serif;
    }

    .login {
        width: 420px;
        margin: auto;
        height: min-content;
        padding: 40px;
        border-radius: 12px;
        background: #ffffff;
    }

        .login h1 {
            font-size: 32px;
            margin-bottom: 25px;
        }

        .login form {
            font-size: 18px;
        }

            .login form .form-group {
                margin-bottom: 12px;
            }

            .login form input[type="submit"] {
                font-size: 18px;
                margin-top: 15px;
            }

    .login-register {
        font-size: .9em;
        color: #162938;
        text-align: center;
        font-weight: 500;
        margin: 25px 0 10px;
    }

    .back-button {
        text-align: left;
    }

    #facialRecognitionBtn {
        display: flex;
        align-items: center;
        justify-content: center;
    }

        #facialRecognitionBtn:hover {
            background-color: transparent;
            color: #007bff;
        }

        #facialRecognitionBtn ion-icon {
            font-size: 1.5em;
            margin-right: 8px;
        }

</style>





<body>
    

    <div class="login">

        <div class="back-button">
            <p><a class="register-link" asp-controller="Home" asp-action="Index">Back</a></p>
        </div>

        <h1 class="text-center">Employee Login</h1>

        <form class="needs-validation" action="/Staff/StaffLogin" method="post" id="loginForm">
            <div class="form-group was-validated">
                <label class="form-label" for="email">Email address</label>
                <input class="form-control" type="email" id="email" name="email" required autofocus>
                <div class="invalid-feedback">
                    Please enter your email address
                </div>
            </div>
            <div class="form-group was-validated">
                <label class="form-label" for="password">Password</label>
                <input class="form-control" type="password" id="password" name="password" required>
                <div class="invalid-feedback">
                    Please enter your password
                </div>
            </div>
            <div class="form-group form-check">
                <input class="form-check-input" type="checkbox" id="check">
                <label class="form-check-label" for="check">Remember me</label>
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-primary w-100" id="facialRecognitionBtn">
                    <ion-icon name="happy-outline"></ion-icon> Facial Recognition
                </button>
                <!-- Add this <video> element above the login form, within <body> -->

                <video id="videoFeed" autoplay playsinline style="display: none;" crossorigin="anonymous"></video>

            </div>
            <input class="btn btn-success w-100" type="submit" value="SIGN IN">

            <br />
            <span style="color:red;">@TempData["Message"]</span>
        </form>

    </div>
    <!-- Add this script section at the end of your HTML, above </body> -->

    <script>
        document.getElementById('facialRecognitionBtn').addEventListener('click', function () {
            console.log('Button clicked');

            // Make an AJAX request to your Flask server
            fetch('https://ecee-2406-3003-206b-223-4597-6120-aef2-ad51.ngrok-free.app/video_feed')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    console.log('Response from server:', data);

                    // Update the code based on the response content
                    if (data.includes('started')) {
                        // Hide the login form
                        document.getElementById('videoFeed').style.display = 'block';
                    } else {
                        console.error('Error: Face detection not started. Response:', data);
                    }
                })
                .catch(error => {
                    console.error('Error starting face detection:', error.message);
                });
        });
    </script>
</body>

</html>
